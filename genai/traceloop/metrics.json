{
  "schemaVersion": "1.0",
  "metrics": [
    {
      "id": "count_chat_calls_traceloop",
      "displayName": "Number of chat calls",
      "description": "The number of chat GenAI calls, to any GenAI provider. The default desired direction is specified as increase: appropriate for those looking to increase usage of chat features. However, this choice of direction is inappropriate if primary concern is cost, in which case the metric definition should be updated to specify `Decrease` as the desiredDirection.",
      "lifecycle": "Active",
      "tags": [
        "__Traceloop__",
        "Usage",
        "Important"
      ],
      "desiredDirection": "Increase",
      "definition": {
        "kind": "EventCount",
        "event": {
          "eventName": "traceloop.chat"
        }
      }
    },
    {
      "id": "count_chat_users_traceloop",
      "displayName": "Number of chat users",
      "description": "The number of users with at least one GenAI chat calls to any GenAI provider. The default desired direction is specified as increase: appropriate for those looking to increase usage of chat features.",
      "lifecycle": "Active",
      "tags": [
        "__Traceloop__",
        "Usage"
      ],
      "desiredDirection": "Increase",
      "definition": {
        "kind": "UserCount",
        "event": {
          "eventName": "traceloop.chat"
        }
      }
    },
    {
      "id": "avg_chat_tokens_traceloop",
      "displayName": "Average chat usage tokens",
      "description": "The average usage tokens (both input and output) per GenAI chat call. A single request may spark multiple GenAI chat calls -- as when tool calls are initiated as part of the request. Each chat call contributes 1 vote to this metric. Assuming equal # of chat calls, we want total token usage to reduce or remain constant.",
      "lifecycle": "Active",
      "tags": [
        "__Traceloop__",
        "Cost",
        "Important"
      ],
      "desiredDirection": "Decrease",
      "definition": {
        "kind": "Average",
        "value": {
          "eventName": "traceloop.chat",
          "eventProperty": "llm.usage.total_tokens"
        }
      }
    },
    {
      "id": "sum_chat_tokens_traceloop",
      "displayName": "Total chat usage tokens",
      "description": "The total usage tokens (both input and output) for GenAI chat calls. Assuming equal number of chat calls, we want total token usage to reduce or remain constant. The statistical test on this metric compares the token usage per event: meaning increased usage may increase the total usage tokens without flagging this metric as statistically significant.",
      "lifecycle": "Active",
      "tags": [
        "__Traceloop__",
        "Cost",
        "Important"
      ],
      "desiredDirection": "Decrease",
      "definition": {
        "kind": "Sum",
        "value": {
          "eventName": "traceloop.chat",
          "eventProperty": "llm.usage.total_tokens"
        }
      }
    },
    {
      "id": "avg_chat_call_duration_traceloop",
      "displayName": "Average chat call duration [ms]",
      "description": "The average duration in milliseconds per GenAI chat operation. Duration is measured by the DurationMS property of the span capturing chat call completion.",
      "lifecycle": "Active",
      "tags": [
        "__Traceloop__",
        "Performance",
        "Important"
      ],
      "desiredDirection": "Decrease",
      "definition": {
        "kind": "Average",
        "value": {
          "eventName": "traceloop.chat",
          "eventProperty": "DurationMS",
          "filter": "DurationMS > 0"
        }
      }
    }
  ]
}